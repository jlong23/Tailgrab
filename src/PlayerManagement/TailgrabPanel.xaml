<Window x:Class="Tailgrab.PlayerManagement.TailgrabPanel"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
xmlns:local="clr-namespace:Tailgrab.PlayerManagement"
Title="Tailgrab Player Panel"
        Width="1080" Height="750"
        FontFamily="Segoe UI"
        Language="en-US"
        WindowStartupLocation="CenterOwner"
        UseLayoutRounding="True"
        TextOptions.TextFormattingMode="Display">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <Grid Margin="8" Grid.Row="0">
            <TabControl>
                <TabItem Header="Active Players">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="316*"/>
                            <ColumnDefinition Width="25*"/>
                            <ColumnDefinition Width="364*"/>
                            <ColumnDefinition Width="68*"/>
                            <ColumnDefinition Width="285*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="13*"/>
                            <RowDefinition Height="267*"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*" MinHeight="100"/>
                        </Grid.RowDefinitions>

                        <StackPanel Orientation="Horizontal" Margin="0,0,0,6" Grid.ColumnSpan="5">
                            <TextBox Name="ActiveFilterBox" Width="300" Margin="0,0,8,0" />
                            <Button Content="Apply Filter" Click="ActiveApplyFilter_Click" Margin="0,0,6,0"/>
                            <Button Content="Clear Filter" Click="ActiveClearFilter_Click"/>
                        </StackPanel>

                        <ListView Name="ActiveListView" ItemsSource="{Binding ActiveView}" SelectedItem="{Binding SelectedActive, Mode=TwoWay}" Margin="0,25,0,1" Grid.RowSpan="2" Grid.ColumnSpan="5">
                            <ListView.Resources>
                                <Style TargetType="{x:Type ListViewItem}">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding HighlightClass}" Value="Normal">
                                            <Setter Property="Background" Value="#FF1E1E1E" />
                                            <Setter Property="Foreground" Value="#FFE6E6E6" />
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding HighlightClass}" Value="Yellow">
                                            <Setter Property="Background" Value="Yellow" />
                                            <Setter Property="Foreground" Value="Black" />
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding HighlightClass}" Value="Red">
                                            <Setter Property="Background" Value="Red" />
                                            <Setter Property="Foreground" Value="Yellow" />
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding HighlightClass}" Value="Purple">
                                            <Setter Property="Background" Value="Purple" />
                                            <Setter Property="Foreground" Value="Yellow" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </ListView.Resources>
                            <ListView.ContextMenu>
                                <ContextMenu>
                                    <MenuItem Header="Filter">
                                        <MenuItem Header="Filter by selected DisplayName" Click="ActiveFilterBySelected_Click"/>
                                    </MenuItem>
                                </ContextMenu>
                            </ListView.ContextMenu>

                            <ListView.View>
                                <GridView>
                                    <GridViewColumn Width="180">
                                        <GridViewColumn.Header>
                                            <GridViewColumnHeader Content="Display Name" Tag="DisplayName" Click="GridViewColumnHeader_Click"/>
                                        </GridViewColumn.Header>
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding DisplayName}" TextWrapping="NoWrap"/>
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>

                                    <GridViewColumn Width="110">
                                        <GridViewColumn.Header>
                                            <GridViewColumnHeader Content="Avatar Name" Tag="AvatarName" Click="GridViewColumnHeader_Click"/>
                                        </GridViewColumn.Header>
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding AvatarName}" />
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>

                                    <GridViewColumn Width="90">
                                        <GridViewColumn.Header>
                                            <GridViewColumnHeader Name="ActivePlayerInstanceStart"  Content="Pen Activity" Tag="PenActivity" Click="GridViewColumnHeader_Click"/>
                                        </GridViewColumn.Header>
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding PenActivity}" />
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>

                                    <GridViewColumn Width="160">
                                        <GridViewColumn.Header>
                                            <GridViewColumnHeader Content="Instance Start ▼" Tag="InstanceStartTime" Click="GridViewColumnHeader_Click"/>
                                        </GridViewColumn.Header>
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding InstanceStartTime}" />
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>

                                    <GridViewColumn Width="330">
                                        <GridViewColumn.Header>
                                            <GridViewColumnHeader Content="Alert Messages" Tag="UserId" Click="GridViewColumnHeader_Click"/>
                                        </GridViewColumn.Header>
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding AlertMessages}" />
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>

                                    <!-- Actions column -->
                                    <GridViewColumn Width="80">
                                        <GridViewColumn.Header>
                                            <GridViewColumnHeader Content="Copy Profile" />
                                        </GridViewColumn.Header>
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <Button Content="Copy" Click="CopyPlayer_Click" Padding="4,2"/>
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>

                                    <!-- Actions column -->
                                    <GridViewColumn Width="80">
                                        <GridViewColumn.Header>
                                            <GridViewColumnHeader Content="Profile Rpt" />
                                        </GridViewColumn.Header>
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <Button Content="Report" Click="ReportPlayer_Click" Padding="4,2" ToolTip="{Binding AIEval}"/>
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>

                                </GridView>
                            </ListView.View>
                        </ListView>

                        <GridSplitter Grid.Row="2" Grid.ColumnSpan="5" Height="5" HorizontalAlignment="Stretch" VerticalAlignment="Center" Background="#FF3F3F46" ShowsPreview="False" ResizeDirection="Rows"/>

                        <Grid Margin="0,0,0,6" Grid.ColumnSpan="5" Grid.Row="3">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <TextBox Name="UserPofileBox" Grid.Column="0" Height="auto" Margin="0,0,4,0" IsReadOnly="True" TextWrapping="Wrap" VerticalScrollBarVisibility="Auto">
                                <TextBox.Text>
                                    <MultiBinding StringFormat="{}User Profile:&#x0a;{0}&#x0a;&#x0a;AI Evaluation:&#x0a;{1}" Mode="OneWay">
                                        <Binding Path="SelectedActive.Profile" Mode="OneWay" FallbackValue="" TargetNullValue=""/>
                                        <Binding Path="SelectedActive.AIEval" Mode="OneWay" FallbackValue="" TargetNullValue=""/>
                                    </MultiBinding>
                                </TextBox.Text>
                            </TextBox>

                            <GridSplitter Grid.Column="1" Width="5" HorizontalAlignment="Center" VerticalAlignment="Stretch" Background="#FF3F3F46" ShowsPreview="False"/>

                            <TextBox Name="UserAlertsBox" Grid.Column="2" Height="auto" Margin="4,0,8,0" IsReadOnly="True" TextWrapping="Wrap" VerticalScrollBarVisibility="Auto" Text="{Binding SelectedActive.History, Mode=OneWay, FallbackValue='', TargetNullValue=''}" />
                        </Grid>

                        <!-- Overlay Panel for Report Profile -->
                        <Border Name="OverlayProfileReport" 
                            Grid.Row="0" 
                            Grid.RowSpan="3"
                            Grid.ColumnSpan="5"
                            Background="#CC000000" 
                            Visibility="Collapsed"
                            Panel.ZIndex="1000">
                            <Border Background="#FF2D2D30" 
                                MaxWidth="650" 
                                MaxHeight="500" 
                                CornerRadius="8"
                                Padding="16"
                                VerticalAlignment="Center"
                                HorizontalAlignment="Center">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>

                                    <!-- Title -->
                                    <TextBlock Grid.Row="0" 
                                           Text="Report User Profile" 
                                           FontSize="20" 
                                           FontWeight="Bold" 
                                           Foreground="#FFE6E6E6"
                                           Margin="0,0,0,16"/>

                                    <!-- User ID -->
                                    <StackPanel Grid.Row="1" Margin="0,0,0,12">
                                        <Label Content="User ID: *" FontWeight="Bold" Foreground="#FFE6E6E6"/>
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <TextBox Name="OverlayProfileReportUserIdTextBox" Grid.Column="0" IsReadOnly="True"/>
                                            <Label Name="OverlayProfileReportUserIdError" 
                                               Grid.Column="1" 
                                               Content="Required" 
                                               Foreground="Red" 
                                               FontWeight="Bold"
                                               Margin="8,0,0,0"
                                               VerticalAlignment="Center"
                                               Visibility="Collapsed"/>
                                        </Grid>
                                    </StackPanel>

                                    <!-- Category -->
                                    <StackPanel Grid.Row="2" Margin="0,0,0,12">
                                        <Label Content="Category:" FontWeight="Bold" Foreground="#FFE6E6E6"/>
                                        <TextBox Name="OverlayProfileReportCategoryTextBox" IsReadOnly="True" Text="Profile"/>
                                    </StackPanel>

                                    <!-- Report Reason -->
                                    <StackPanel Grid.Row="3" Margin="0,0,0,12">
                                        <Label Content="Report Reason:" FontWeight="Bold" Foreground="#FFE6E6E6"/>
                                        <ComboBox Name="OverlayProfileReportReasonComboBox" 
                                              DisplayMemberPath="DisplayName"
                                              SelectedValuePath="Value"
                                              SelectedIndex="0"/>
                                    </StackPanel>

                                    <!-- Report Description -->
                                    <StackPanel Grid.Row="4" Margin="0,0,0,12">
                                        <Label Content="Report Description (AI Evaluation):" FontWeight="Bold" Foreground="#FFE6E6E6"/>
                                        <TextBox Name="OverlayProfileReportDescriptionTextBox" 
                                             TextWrapping="Wrap" 
                                             AcceptsReturn="True" 
                                             VerticalScrollBarVisibility="Auto"
                                             IsReadOnly="False"
                                             MinHeight="200"/>
                                    </StackPanel>

                                    <!-- Action Buttons -->
                                    <StackPanel Grid.Row="5" Orientation="Horizontal" HorizontalAlignment="Right">
                                        <Button Name="OverlayProfileReportCancelButton" Content="Cancel" Width="100" Margin="0,0,12,0" Click="OverlayProfileReportCancel_Click"/>
                                        <Button Name="OverlayProfileReportSubmitButton" Content="Submit" Width="100" Click="OverlayProfileReportSubmit_Click"/>
                                    </StackPanel>
                                </Grid>
                            </Border>
                        </Border>

                    </Grid>
                </TabItem>

                <TabItem Header="Past Players">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <StackPanel Orientation="Horizontal" Margin="0,0,0,6">
                            <TextBox Name="PastFilterBox" Width="300" Margin="0,0,8,0" />
                            <Button Content="Apply Filter" Click="PastApplyFilter_Click" Margin="0,0,6,0"/>
                            <Button Content="Clear Filter" Click="PastClearFilter_Click"/>
                        </StackPanel>

                        <ListView Name="PastListView" Grid.Row="1" ItemsSource="{Binding PastView}" SelectedItem="{Binding SelectedPast, Mode=TwoWay}">
                            <ListView.Resources>
                                <Style TargetType="{x:Type ListViewItem}">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding HighlightClass}" Value="Normal">
                                            <Setter Property="Background" Value="#FF1E1E1E" />
                                            <Setter Property="Foreground" Value="#FFE6E6E6" />
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding HighlightClass}" Value="Yellow">
                                            <Setter Property="Background" Value="Yellow" />
                                            <Setter Property="Foreground" Value="Black" />
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding HighlightClass}" Value="Red">
                                            <Setter Property="Background" Value="Red" />
                                            <Setter Property="Foreground" Value="Yellow" />
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding HighlightClass}" Value="Purple">
                                            <Setter Property="Background" Value="Purple" />
                                            <Setter Property="Foreground" Value="Yellow" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </ListView.Resources>

                            <ListView.ContextMenu>
                                <ContextMenu>
                                    <MenuItem Header="Filter">
                                        <MenuItem Header="Filter by selected DisplayName" Click="PastFilterBySelected_Click"/>
                                    </MenuItem>
                                </ContextMenu>
                            </ListView.ContextMenu>

                            <ListView.View>
                                <GridView>
                                    <GridViewColumn Width="180">
                                        <GridViewColumn.Header>
                                            <GridViewColumnHeader Content="Display Name" Tag="DisplayName" Click="GridViewColumnHeader_Click"/>
                                        </GridViewColumn.Header>
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding DisplayName}" TextWrapping="NoWrap"/>
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>

                                    <GridViewColumn Width="110">
                                        <GridViewColumn.Header>
                                            <GridViewColumnHeader Content="Avatar Name" Tag="AvatarName" Click="GridViewColumnHeader_Click"/>
                                        </GridViewColumn.Header>
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding AvatarName}" />
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>

                                    <GridViewColumn Width="90">
                                        <GridViewColumn.Header>
                                            <GridViewColumnHeader Content="Pen Activity" Tag="PenActivity" Click="GridViewColumnHeader_Click"/>
                                        </GridViewColumn.Header>
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding PenActivity}" />
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>

                                    <GridViewColumn Width="160">
                                        <GridViewColumn.Header>
                                            <GridViewColumnHeader Name="PastPlayerInstanceEnd" Content="Instance End ▼" Tag="InstanceEndTime" Click="GridViewColumnHeader_Click"/>
                                        </GridViewColumn.Header>
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding InstanceEndTime}" />
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>

                                    <GridViewColumn Width="330">
                                        <GridViewColumn.Header>
                                            <GridViewColumnHeader Content="Alert Messages" Tag="UserId" Click="GridViewColumnHeader_Click"/>
                                        </GridViewColumn.Header>
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding AlertMessages}" />
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>

                                    <!-- Actions column -->
                                    <GridViewColumn Width="80">
                                        <GridViewColumn.Header>
                                            <GridViewColumnHeader Content="Copy Profile" />
                                        </GridViewColumn.Header>
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <Button Content="Copy" Click="CopyPlayer_Click" Padding="4,2"/>
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>

                                    <!-- Actions column -->
                                    <GridViewColumn Width="80">
                                        <GridViewColumn.Header>
                                            <GridViewColumnHeader Content="Profile Rpt" />
                                        </GridViewColumn.Header>
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <Button Content="Report" Click="ReportPlayer_Click" Padding="4,2" ToolTip="{Binding AIEval}"/>
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>

                                </GridView>
                            </ListView.View>
                        </ListView>
                    </Grid>
                </TabItem>

                <TabItem Header="Prints">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="34*"/>
                            <ColumnDefinition Width="7*"/>
                            <ColumnDefinition Width="188*"/>
                            <ColumnDefinition Width="46*"/>
                            <ColumnDefinition Width="783*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>

                        <StackPanel Orientation="Horizontal" Margin="0,0,0,6" Grid.ColumnSpan="5">
                            <TextBox Name="PrintFilterBox" Width="300" Margin="0,0,8,0" />
                            <Button Content="Apply Filter" Click="PrintApplyFilter_Click" Margin="0,0,6,0"/>
                            <Button Content="Clear Filter" Click="PrintClearFilter_Click"/>
                            <Button Content="Report Inventory" Click="ReportPrintInventory_Click" HorizontalAlignment="Right" Margin="8,0,0,0"/>
                        </StackPanel>

                        <!-- Show each player and their prints -->
                        <ListView Name="PrintListView" Grid.Row="1" ItemsSource="{Binding PrintView}" Grid.ColumnSpan="5">
                            <ListView.ItemTemplate>
                                <DataTemplate>
                                    <Border BorderBrush="Gray" BorderThickness="0,0,0,1" Padding="6">
                                        <StackPanel Orientation="Vertical">
                                            <StackPanel Orientation="Horizontal" Margin="0,0,0,4">
                                                <TextBlock FontWeight="Bold" Text="{Binding DisplayName}" />
                                                <TextBlock Margin="8,0,0,0" FontStyle="Italic" Text="{Binding UserId}" />
                                            </StackPanel>
                                            <ScrollViewer MaxHeight="300" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
                                                <ItemsControl ItemsSource="{Binding Prints}">
                                                    <ItemsControl.ItemTemplate>
                                                        <DataTemplate>
                                                            <Grid Margin="0,2,0,2">
                                                                <Grid.RowDefinitions>
                                                                    <RowDefinition Height="Auto"/>
                                                                    <RowDefinition Height="Auto"/>
                                                                </Grid.RowDefinitions>
                                                                <Grid.ColumnDefinitions>
                                                                    <ColumnDefinition Width="300" />
                                                                    <ColumnDefinition Width="200" />
                                                                    <ColumnDefinition Width="200" />
                                                                    <ColumnDefinition Width="100" />
                                                                    <ColumnDefinition Width="100" />
                                                                </Grid.ColumnDefinitions>

                                                                <!-- First Row -->
                                                                <TextBlock Grid.Row="0" Grid.Column="0" Text="{Binding PrintId}" VerticalAlignment="Center"/>
                                                                <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding AuthorName}" VerticalAlignment="Center"/>
                                                                <TextBlock Grid.Row="0" Grid.Column="2" Text="{Binding Timestammp, StringFormat={}{0:u}}" VerticalAlignment="Center"/>
                                                                <TextBlock Grid.Row="0" Grid.Column="3" Text="{Binding AIClass}" VerticalAlignment="Center"/>

                                                                <!-- Second Row - Button -->
                                                                <Button Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="4" 
                                                                        Content="Report Print Item" 
                                                                        Click="ReportPrintInventoryItem_Click"
                                                                        Tag="{Binding}"
                                                                        Margin="0,4,0,0"
                                                                        Padding="4,2"
                                                                        HorizontalAlignment="Left"/>

                                                                <!-- Image spanning both rows -->
                                                                <Border Grid.Row="0" Grid.Column="4" Grid.RowSpan="2" 
                                                                        BorderBrush="Gray" 
                                                                        BorderThickness="1" 
                                                                        Padding="2">
                                                                    <TextBlock>
                                                                        <Hyperlink NavigateUri="{Binding PrintUrl}" RequestNavigate="PrintHyperlink_RequestNavigate">
                                                                            <InlineUIContainer>
                                                                                <Image Source="{Binding PrintUrl}" Width="100" Height="100" Stretch="Uniform" />
                                                                            </InlineUIContainer>
                                                                        </Hyperlink>
                                                                    </TextBlock>
                                                                </Border>
                                                            </Grid>
                                                        </DataTemplate>
                                                    </ItemsControl.ItemTemplate>
                                                </ItemsControl>
                                            </ScrollViewer>
                                        </StackPanel>
                                    </Border>
                                </DataTemplate>
                            </ListView.ItemTemplate>
                        </ListView>
                        <!-- Overlay Panel for Report Inventory -->
                        <Border Name="ReportPrintInventoryOverlay" 
                            Grid.Row="0" 
                            Grid.RowSpan="2" 
                            Background="#CC000000" 
                            Visibility="Collapsed"
                            Panel.ZIndex="1000" Grid.ColumnSpan="5">
                            <Border Background="#FF2D2D30" 
                                MaxWidth="950" 
                                MaxHeight="550" 
                                CornerRadius="8"
                                Padding="16"
                                VerticalAlignment="Center"
                                HorizontalAlignment="Center">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition/>
                                        <ColumnDefinition Width="250"/>
                                    </Grid.ColumnDefinitions>

                                    <!-- Left side - Form fields -->
                                    <Grid Grid.Column="0" Margin="0,0,16,0">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="*"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>

                                        <!-- Title -->
                                        <TextBlock Grid.Row="0" 
                                               Text="Report Print Content" 
                                               FontSize="20" 
                                               FontWeight="Bold" 
                                               Foreground="#FFE6E6E6"
                                               Margin="0,0,0,16"/>

                                        <!-- Print ID -->
                                        <StackPanel Grid.Row="1" Margin="0,0,0,12">
                                            <Label Content="Print ID: *" FontWeight="Bold" Foreground="#FFE6E6E6"/>
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                <TextBox Name="PrintOverlayInventoryIdTextBox" Grid.Column="0" TextChanged="OverlayPrintOnInputFieldChanged"/>
                                                <Label Name="PrintOverlayInventoryIdError" 
                                                       Grid.Column="1" 
                                                       Content="Required" 
                                                       Foreground="Yellow" 
                                                       FontWeight="Bold"
                                                       Margin="8,0,0,0"
                                                       VerticalAlignment="Center"
                                                       Visibility="Collapsed"/>
                                            </Grid>
                                        </StackPanel>

                                        <!-- User ID -->
                                        <StackPanel Grid.Row="2" Margin="0,0,0,12">
                                            <Label Content="User ID: *" FontWeight="Bold" Foreground="#FFE6E6E6"/>
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                <TextBox Name="PrintOverlayUserIdTextBox" Grid.Column="0" IsReadOnly="True"/>
                                                <Label Name="PrintOverlayUserIdError" 
                                                       Grid.Column="1" 
                                                       Content="Required" 
                                                       Foreground="Yellow" 
                                                       FontWeight="Bold"
                                                       Margin="8,0,0,0"
                                                       VerticalAlignment="Center"
                                                       Visibility="Collapsed"/>
                                            </Grid>
                                        </StackPanel>

                                        <!-- Category -->
                                        <StackPanel Grid.Row="3" Margin="0,0,0,12">
                                            <Label Content="Category:" FontWeight="Bold" Foreground="#FFE6E6E6"/>
                                            <TextBox Name="PrintOverlayCategoryTextBox" IsReadOnly="True"/>
                                        </StackPanel>

                                        <!-- Report Type -->
                                        <StackPanel Grid.Row="4" Margin="0,0,0,12">
                                            <Label Content="Report Reason:" FontWeight="Bold" Foreground="#FFE6E6E6"/>
                                            <ComboBox Name="PrintOverlayReportReasonComboBox" 
                                                  DisplayMemberPath="DisplayName"
                                                  SelectedValuePath="Value"
                                                  SelectedIndex="0"/>
                                        </StackPanel>

                                        <!-- Report Description -->
                                        <StackPanel Grid.Row="5" Margin="0,0,0,12">
                                            <Label Content="Report Description (AI Evaluation):" FontWeight="Bold" Foreground="#FFE6E6E6"/>
                                            <TextBox Name="PrintOverlayReportDescriptionTextBox" 
                                                 TextWrapping="Wrap" 
                                                 AcceptsReturn="True" 
                                                 VerticalScrollBarVisibility="Auto"
                                                 IsReadOnly="False"
                                                 MinHeight="150"/>
                                        </StackPanel>

                                        <!-- Action Buttons -->
                                        <StackPanel Grid.Row="6" Orientation="Horizontal" HorizontalAlignment="Right">
                                            <Button Name="PrintOverlayCancelButton" Content="Cancel" Width="100" Margin="0,0,12,0" Click="PrintOverlayCancel_Click"/>
                                            <Button Name="PrintOverlaySubmitButton" Content="Submit" Width="100" Click="PrintOverlaySubmit_Click"/>
                                        </StackPanel>
                                    </Grid>

                                    <!-- Right side - Image display -->
                                    <Border Grid.Column="1" 
                                        BorderBrush="Gray" 
                                        BorderThickness="2" 
                                        VerticalAlignment="Top"
                                        Padding="8" 
                                        Height="250" 
                                        Width="230">
                                        <StackPanel>
                                            <Label Content="Image Preview:" FontWeight="Bold" HorizontalAlignment="Center" Foreground="#FFE6E6E6"/>
                                            <Image Name="PrintOverlayInventoryImagePreview" 
                                               Width="200"
                                               Height="200"
                                               Stretch="Uniform"/>
                                        </StackPanel>
                                    </Border>
                                </Grid>
                            </Border>
                        </Border>

                    </Grid>
                </TabItem>

                <TabItem Header="Emoji and Stickers">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="167*"/>
                            <ColumnDefinition Width="14*"/>
                            <ColumnDefinition Width="877*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>

                        <StackPanel Orientation="Horizontal" Margin="0,0,0,6" Grid.ColumnSpan="3">
                            <TextBox Name="EmojiFilterBox" Width="300" Margin="0,0,8,0" />
                            <Button Content="Apply Filter" Click="EmojiApplyFilter_Click" Margin="0,0,6,0"/>
                            <Button Content="Clear Filter" Click="EmojiClearFilter_Click"/>
                            <Button Content="Report Inventory" Click="ReportInventory_Click" HorizontalAlignment="Right" Margin="8,0,0,0"/>
                        </StackPanel>

                        <!-- Show each player and their emojis -->
                        <ListView Name="EmojiListView" Grid.Row="1" ItemsSource="{Binding EmojiView}" Grid.ColumnSpan="3">
                            <ListView.ItemTemplate>
                                <DataTemplate>
                                    <Border BorderBrush="Gray" BorderThickness="0,0,0,1" Padding="6">
                                        <StackPanel Orientation="Vertical">
                                            <StackPanel Orientation="Horizontal" Margin="0,0,0,4">
                                                <TextBlock FontWeight="Bold" Text="{Binding DisplayName}" />
                                                <TextBlock Margin="8,0,0,0" FontStyle="Italic" Text="{Binding UserId}" />
                                            </StackPanel>
                                            <ScrollViewer MaxHeight="300" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
                                                <ItemsControl ItemsSource="{Binding Emojis}">
                                                    <ItemsControl.ItemTemplate>
                                                        <DataTemplate>
                                                            <Grid Margin="0,2,0,2">
                                                                <Grid.RowDefinitions>
                                                                    <RowDefinition Height="Auto"/>
                                                                    <RowDefinition Height="Auto"/>
                                                                </Grid.RowDefinitions>
                                                                <Grid.ColumnDefinitions>
                                                                    <ColumnDefinition Width="300" />
                                                                    <ColumnDefinition Width="200" />
                                                                    <ColumnDefinition Width="200" />
                                                                    <ColumnDefinition Width="100" />
                                                                    <ColumnDefinition Width="100" />
                                                                </Grid.ColumnDefinitions>

                                                                <!-- First Row -->
                                                                <TextBlock Grid.Row="0" Grid.Column="0" Text="{Binding InventoryId}" VerticalAlignment="Center"/>
                                                                <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding InventoryType}" VerticalAlignment="Center"/>
                                                                <TextBlock Grid.Row="0" Grid.Column="2" Text="{Binding SpawnedAt, StringFormat={}{0:u}}" VerticalAlignment="Center"/>
                                                                <TextBlock Grid.Row="0" Grid.Column="3" Text="{Binding AIEvalutation}" VerticalAlignment="Center"/>

                                                                <!-- Second Row - Button -->
                                                                <Button Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="4" 
                                                                    Content="Report Inventory Item" 
                                                                    Click="ReportInventoryItem_Click"
                                                                    Tag="{Binding}"
                                                                    Margin="0,4,0,0"
                                                                    Padding="4,2"
                                                                    HorizontalAlignment="Left"/>

                                                                <!-- Image spanning both rows -->
                                                                <Border Grid.Row="0" Grid.Column="4" Grid.RowSpan="2" 
                                                                    BorderBrush="Gray" 
                                                                    BorderThickness="1" 
                                                                    Padding="2">
                                                                    <TextBlock>
                                                                    <Hyperlink NavigateUri="{Binding ImageUrl}" RequestNavigate="EmojiHyperlink_RequestNavigate">
                                                                        <InlineUIContainer>
                                                                            <Image Source="{Binding ImageUrl}" Width="100" Height="100" Stretch="Uniform" />
                                                                        </InlineUIContainer>
                                                                    </Hyperlink>
                                                                    </TextBlock>
                                                                </Border>
                                                            </Grid>
                                                        </DataTemplate>
                                                    </ItemsControl.ItemTemplate>
                                                </ItemsControl>
                                            </ScrollViewer>
                                        </StackPanel>
                                    </Border>
                                </DataTemplate>
                            </ListView.ItemTemplate>
                        </ListView>

                        <!-- Overlay Panel for Report Inventory -->
                        <Border Name="ReportInventoryOverlay" 
                            Grid.Row="0" 
                            Grid.RowSpan="2" 
                            Background="#CC000000" 
                            Visibility="Collapsed"
                            Panel.ZIndex="1000" Grid.ColumnSpan="3">
                            <Border Background="#FF2D2D30" 
                                MaxWidth="950" 
                                MaxHeight="550" 
                                CornerRadius="8"
                                Padding="16"
                                VerticalAlignment="Center"
                                HorizontalAlignment="Center">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition/>
                                        <ColumnDefinition Width="250"/>
                                    </Grid.ColumnDefinitions>

                                    <!-- Left side - Form fields -->
                                    <Grid Grid.Column="0" Margin="0,0,16,0">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="*"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>

                                        <!-- Title -->
                                        <TextBlock Grid.Row="0" 
                                               Text="Report Emoji or Sticker" 
                                               FontSize="20" 
                                               FontWeight="Bold" 
                                               Foreground="#FFE6E6E6"
                                               Margin="0,0,0,16"/>

                                        <!-- User ID -->
                                        <StackPanel Grid.Row="1" Margin="0,0,0,12">
                                            <Label Content="User ID: *" FontWeight="Bold" Foreground="#FFE6E6E6"/>
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                <TextBox Name="OverlayUserIdTextBox" Grid.Column="0" TextChanged="OverlayOnInputFieldChanged"/>
                                                <Label Name="OverlayUserIdError" 
                                                       Grid.Column="1" 
                                                       Content="Required" 
                                                       Foreground="Yellow" 
                                                       FontWeight="Bold"
                                                       Margin="8,0,0,0"
                                                       VerticalAlignment="Center"
                                                       Visibility="Collapsed"/>
                                            </Grid>
                                        </StackPanel>

                                        <!-- Inventory ID -->
                                        <StackPanel Grid.Row="2" Margin="0,0,0,12">
                                            <Label Content="Inventory ID: *" FontWeight="Bold" Foreground="#FFE6E6E6"/>
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                <TextBox Name="OverlayInventoryIdTextBox" Grid.Column="0" TextChanged="OverlayOnInputFieldChanged"/>
                                                <Label Name="OverlayInventoryIdError" 
                                                       Grid.Column="1" 
                                                       Content="Required" 
                                                       Foreground="Yellow" 
                                                       FontWeight="Bold"
                                                       Margin="8,0,0,0"
                                                       VerticalAlignment="Center"
                                                       Visibility="Collapsed"/>
                                            </Grid>
                                        </StackPanel>

                                        <!-- Category -->
                                        <StackPanel Grid.Row="3" Margin="0,0,0,12">
                                            <Label Content="Category:" FontWeight="Bold" Foreground="#FFE6E6E6"/>
                                            <TextBox Name="OverlayCategoryTextBox" IsReadOnly="True"/>
                                        </StackPanel>

                                        <!-- Report Type -->
                                        <StackPanel Grid.Row="4" Margin="0,0,0,12">
                                            <Label Content="Report Reason:" FontWeight="Bold" Foreground="#FFE6E6E6"/>
                                            <ComboBox Name="OverlayReportReasonComboBox" 
                                                  DisplayMemberPath="DisplayName"
                                                  SelectedValuePath="Value"
                                                  SelectedIndex="0"/>
                                        </StackPanel>

                                        <!-- Report Description -->
                                        <StackPanel Grid.Row="5" Margin="0,0,0,12">
                                            <Label Content="Report Description (AI Evaluation):" FontWeight="Bold" Foreground="#FFE6E6E6"/>
                                            <TextBox Name="OverlayReportDescriptionTextBox" 
                                                 TextWrapping="Wrap" 
                                                 AcceptsReturn="True" 
                                                 VerticalScrollBarVisibility="Auto"
                                                 IsReadOnly="False"
                                                 MinHeight="150"/>
                                        </StackPanel>

                                        <!-- Action Buttons -->
                                        <StackPanel Grid.Row="6" Orientation="Horizontal" HorizontalAlignment="Right">
                                            <Button Name="OverlayCancelButton" Content="Cancel" Width="100" Margin="0,0,12,0" Click="OverlayCancel_Click"/>
                                            <Button Name="OverlaySubmitButton" Content="Submit" Width="100" Click="OverlaySubmit_Click"/>
                                        </StackPanel>
                                    </Grid>

                                    <!-- Right side - Image display -->
                                    <Border Grid.Column="1" 
                                        BorderBrush="Gray" 
                                        BorderThickness="2" 
                                        VerticalAlignment="Top"
                                        Padding="8" 
                                        Height="250" 
                                        Width="230">
                                        <StackPanel>
                                            <Label Content="Image Preview:" FontWeight="Bold" HorizontalAlignment="Center" Foreground="#FFE6E6E6"/>
                                            <Image Name="OverlayInventoryImagePreview" 
                                               Width="200"
                                               Height="200"
                                               Stretch="Uniform"/>
                                        </StackPanel>
                                    </Border>
                                </Grid>
                            </Border>
                        </Border>
                    </Grid>
                </TabItem>

                <TabItem Header="Config">
                    <TabControl>
                        <TabItem Header="Known Avatars">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="29*"/>
                                    <ColumnDefinition Width="89*"/>
                                    <ColumnDefinition Width="27*"/>
                                    <ColumnDefinition Width="44*"/>
                                    <ColumnDefinition Width="16*"/>
                                    <ColumnDefinition Width="172*"/>
                                    <ColumnDefinition Width="284*"/>
                                    <ColumnDefinition Width="392*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="*" />
                                </Grid.RowDefinitions>

                                <StackPanel Orientation="Horizontal" Margin="0,0,0,6" Grid.ColumnSpan="8">
                                    <TextBox Name="AvatarDbFilterBox" Width="300" Margin="0,0,8,0" />
                                    <Button Content="Apply Filter" Click="AvatarDbApplyFilter_Click" Margin="0,0,6,0"/>
                                    <Button Content="Clear Filter" Click="AvatarDbClearFilter_Click"/>
                                    <Button Content="Refresh" Click="AvatarDbRefresh_Click" Margin="8,0,0,0"/>
                                    <!-- Fetch avatar by id -->
                                    <TextBox Name="AvatarIdBox" Width="360" Margin="12,0,8,0" ToolTip="Enter Avatar ID to fetch from VRChat" />
                                    <Button Content="Fetch Avatar by ID" Click="AvatarFetch_Click" Margin="0,0,0,0"/>
                                </StackPanel>

                                <DataGrid Name="AvatarDbGrid" Grid.Row="1" AutoGenerateColumns="False" CanUserSortColumns="True" IsReadOnly="False" ItemsSource="{Binding AvatarDbView}" CellEditEnding="AvatarDbGrid_CellEditEnding" Grid.ColumnSpan="8">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Avatar Name" Binding="{Binding AvatarName}" SortMemberPath="AvatarName" Width="*" />
                                        <DataGridTextColumn Header="Avatar ID" Binding="{Binding AvatarId}" SortMemberPath="AvatarId" Width="300" />
                                        <!-- AlertType as template column: display enum name, edit with ComboBox -->
                                        <DataGridTemplateColumn Header="Alert" SortMemberPath="AlertType" Width="120">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding AlertType}" Foreground="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" />
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                            <DataGridTemplateColumn.CellEditingTemplate>
                                                <DataTemplate>
                                                    <ComboBox ItemsSource="{Binding DataContext.AlertTypeOptions, RelativeSource={RelativeSource AncestorType=Window}}"
                                                          SelectedValuePath="Value" DisplayMemberPath="Key"
                                                          SelectedValue="{Binding AlertType, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellEditingTemplate>
                                        </DataGridTemplateColumn>
                                        <DataGridTextColumn Header="Last Updated" Binding="{Binding UpdatedAt, StringFormat={}{0:u}}" SortMemberPath="UpdatedAt" Width="200" IsReadOnly="True" />
                                        <DataGridTemplateColumn Header="Browser" Width="80">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBlock>
                                                    <Hyperlink NavigateUri="{Binding AvatarId, StringFormat=https://vrchat.com/home/avatar/{0}}"
                                                               RequestNavigate="AvatarHyperlink_RequestNavigate">
                                                        Open
                                                    </Hyperlink>
                                                    </TextBlock>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </Grid>
                        </TabItem>
                        <TabItem Header="Known Groups">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="134*"/>
                                    <ColumnDefinition Width="919*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="*" />
                                </Grid.RowDefinitions>

                                <StackPanel Orientation="Horizontal" Margin="0,0,0,6" Grid.ColumnSpan="2">
                                    <TextBox Name="GroupDbFilterBox" Width="300" Margin="0,0,8,0" />
                                    <Button Content="Apply Filter" Click="GroupDbApplyFilter_Click" Margin="0,0,6,0"/>
                                    <Button Content="Clear Filter" Click="GroupDbClearFilter_Click"/>
                                    <Button Content="Refresh" Click="GroupDbRefresh_Click" Margin="8,0,0,0"/>
                                    <!-- Fetch Group by id -->
                                    <TextBox Name="GroupIdBox" Width="360" Margin="12,0,8,0" ToolTip="Enter Group ID to fetch from VRChat" />
                                    <Button Content="Fetch Group by ID" Click="GroupFetch_Click" Margin="0,0,0,0"/>
                                </StackPanel>

                                <DataGrid Name="GroupDbGrid" Grid.Row="1" AutoGenerateColumns="False" CanUserSortColumns="True" IsReadOnly="False" ItemsSource="{Binding GroupDbView}" CellEditEnding="GroupDbGrid_CellEditEnding" Grid.ColumnSpan="2">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Group Name" Binding="{Binding GroupName}" SortMemberPath="GroupName" Width="*" />
                                        <DataGridTextColumn Header="Group ID" Binding="{Binding GroupId}" SortMemberPath="GroupId" Width="300" />
                                        <!-- IsBOS as template column: display Yes/No, edit with ComboBox -->
                                        <DataGridTemplateColumn Header="Alert" SortMemberPath="IsBos" Width="120">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding AlertType}" Foreground="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" />
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                            <DataGridTemplateColumn.CellEditingTemplate>
                                                <DataTemplate>
                                                    <ComboBox ItemsSource="{Binding DataContext.AlertTypeOptions, RelativeSource={RelativeSource AncestorType=Window}}"
                                                          SelectedValuePath="Value" DisplayMemberPath="Key"
                                                          SelectedValue="{Binding AlertType, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellEditingTemplate>
                                        </DataGridTemplateColumn>
                                        <DataGridTextColumn Header="Last Updated" Binding="{Binding UpdatedAt, StringFormat={}{0:u}}" SortMemberPath="UpdatedAt" Width="200" IsReadOnly="True" />
                                        <DataGridTemplateColumn Header="Browser" Width="80">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBlock>
                                                    <Hyperlink NavigateUri="{Binding GroupId, StringFormat=https://vrchat.com/home/group/{0}}"
                                                               RequestNavigate="GroupHyperlink_RequestNavigate">
                                                        Open
                                                    </Hyperlink>
                                                    </TextBlock>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </Grid>
                        </TabItem>
                        <TabItem Header="Known Users">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="*" />
                                </Grid.RowDefinitions>

                                <StackPanel Orientation="Horizontal" Margin="0,0,0,6">
                                    <TextBox Name="UserDbFilterBox" Width="300" Margin="0,0,8,0" />
                                    <Button Content="Apply Filter" Click="UserDbApplyFilter_Click" Margin="0,0,6,0"/>
                                    <Button Content="Clear Filter" Click="UserDbClearFilter_Click"/>
                                    <Button Content="Refresh" Click="UserDbRefresh_Click" Margin="8,0,0,0"/>
                                </StackPanel>

                                <DataGrid Name="UserDbGrid" Grid.Row="1" AutoGenerateColumns="False" CanUserSortColumns="True" IsReadOnly="False" ItemsSource="{Binding UserDbView}" CellEditEnding="UserDbGrid_CellEditEnding">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Display Name" Binding="{Binding DisplayName}" SortMemberPath="DisplayName" Width="*" />
                                        <DataGridTextColumn Header="User ID" Binding="{Binding UserId}" SortMemberPath="UserId" Width="300" />
                                        <DataGridTextColumn Header="Elapsed Minutes" Binding="{Binding ElapsedMinutes, StringFormat=N1}" SortMemberPath="ElapsedMinutes" Width="120">
                                            <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="HorizontalAlignment" Value="Right" />
                                                    <Setter Property="TextAlignment" Value="Right" />
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                            <DataGridTextColumn.EditingElementStyle>
                                                <Style TargetType="TextBox">
                                                    <Setter Property="HorizontalContentAlignment" Value="Right" />
                                                </Style>
                                            </DataGridTextColumn.EditingElementStyle>
                                        </DataGridTextColumn>
                                        <DataGridTextColumn Header="Last Updated" Binding="{Binding UpdatedAt, StringFormat={}{0:u}}" SortMemberPath="UpdatedAt" Width="200" IsReadOnly="True" />
                                        <DataGridTemplateColumn Header="Browser" Width="80">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBlock>
                                                    <Hyperlink NavigateUri="{Binding UserId, StringFormat=https://vrchat.com/home/user/{0}}"
                                                               RequestNavigate="UserHyperlink_RequestNavigate">
                                                        Open
                                                    </Hyperlink>
                                                    </TextBlock>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </Grid>
                        </TabItem>
                        <TabItem Header="Line Matchers">
                            <Grid>
                                <TextBlock Margin="12" Text="Config view not implemented yet." />
                            </Grid>
                        </TabItem>
                        <TabItem Header="Secrets">
                            <Grid Margin="6">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="*" />
                                </Grid.RowDefinitions>

                                <GroupBox Header="VR Chat Credentials" Margin="0,0,0,6" Grid.Row="0">
                                    <Grid Margin="6">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                        </Grid.RowDefinitions>

                                        <Label Grid.Row="0" Grid.Column="0" Content="User:" VerticalAlignment="Center"/>
                                        <TextBox Grid.Row="0" Grid.Column="1" Name="VrUserBox" Width="300" Margin="6,2" />

                                        <Label Grid.Row="1" Grid.Column="0" Content="Password:" VerticalAlignment="Center"/>
                                        <PasswordBox Grid.Row="1" Grid.Column="1" Name="VrPassBox" Width="300" Margin="6,2" />

                                        <Label Grid.Row="2" Grid.Column="0" Content="2FA Key:" VerticalAlignment="Center"/>
                                        <PasswordBox Grid.Row="2" Grid.Column="1" Name="Vr2FaBox" Width="300" Margin="6,2" />
                                    </Grid>
                                </GroupBox>

                                <GroupBox Header="Ban On Sight Management" Margin="0,6,0,6" Grid.Row="1">
                                    <Grid Margin="6">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                        </Grid.RowDefinitions>

                                        <Label Grid.Row="0" Grid.Column="0" Content="Avatar GIST Url:" VerticalAlignment="Center"/>
                                        <TextBox Grid.Row="0" Grid.Column="1" Name="avatarGistUrl" Width="300" Margin="6,2" />

                                        <Label Grid.Row="1" Grid.Column="0" Content="Group GIST Url:" VerticalAlignment="Center"/>
                                        <TextBox Grid.Row="1" Grid.Column="1" Name="groupGistUrl" Width="300" Margin="6,2" />
                                    </Grid>
                                </GroupBox>

                                <GroupBox Header="Ollama Cloud Credentials" Margin="0,6,0,6" Grid.Row="2">
                                    <Grid Margin="6">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                        </Grid.RowDefinitions>

                                        <Label Grid.Row="0" Grid.Column="0" Content="Ollama Endpoint:" VerticalAlignment="Center"/>
                                        <TextBox Grid.Row="0" Grid.Column="1" Name="VrOllamaEndpointBox" Width="400" Margin="6,2" />

                                        <Label Grid.Row="1" Grid.Column="0" Content="Ollama API Key:" VerticalAlignment="Center"/>
                                        <PasswordBox Grid.Row="1" Grid.Column="1" Name="VrOllamaBox" Width="400" Margin="6,2" />

                                        <Label Grid.Row="2" Grid.Column="0" Content="Ollama Model Name:" VerticalAlignment="Center"/>
                                        <TextBox Grid.Row="2" Grid.Column="1" Name="VrOllamaModelBox" Width="400" Margin="6,2" />

                                        <Label Grid.Row="3" Grid.Column="0" Content="Profile AI Prompt:" VerticalAlignment="Center"/>
                                        <TextBox Grid.Row="3" Grid.Column="1" Name="VrOllamaPromptBox" Width="800" Height="60" Margin="6,2" TextWrapping="Wrap"/>

                                        <Label Grid.Row="4" Grid.Column="0" Content="Image AI Prompt:" VerticalAlignment="Center"/>
                                        <TextBox Grid.Row="4" Grid.Column="1" Name="VrOllamaImagePromptBox" Width="800" Height="60" Margin="6,2" TextWrapping="Wrap"/>

                                    </Grid>
                                </GroupBox>

                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Top" Margin="0,12,0,0" Grid.Row="3">
                                    <Button Content="Save Config" Click="SaveConfig_Click" Width="120" />
                                </StackPanel>
                            </Grid>
                        </TabItem>
                        <TabItem Header="Alerts">
                            <Grid Margin="6">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="auto" />
                                    <RowDefinition Height="*" />
                                </Grid.RowDefinitions>

                                <GroupBox Header="Alert Sounds" Grid.Row="0" Margin="0,0,0,6">
                                    <Grid Margin="6">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="63*" />
                                            <ColumnDefinition Width="233*" />
                                            <ColumnDefinition Width="233*" />
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                        </Grid.RowDefinitions>

                                        <Label Grid.Column="0" Content="Avatar Alert:" VerticalAlignment="Center" HorizontalAlignment="Left" Height="26" Margin="32,0,0,0" Width="75"/>

                                        <StackPanel Grid.Row="0" Grid.Column="1" Orientation="Horizontal" Margin="0,0,0,6" Grid.ColumnSpan="2">
                                            <Label Content="Warn:" VerticalAlignment="Center" HorizontalAlignment="Left" Height="26" Margin="32,0,0,0" Width="75"/>
                                            <ComboBox Name="AvatarWarnSound" ItemsSource="{Binding DataContext.AlertSoundOptions, RelativeSource={RelativeSource AncestorType=Window}}"
                                                          SelectedValuePath="Value" DisplayMemberPath="Key" Margin="2,2,2,2" Width="200"/>

                                            <Label Content="Color:" VerticalAlignment="Center" HorizontalAlignment="Left" Height="26" Margin="32,0,0,0" Width="75"/>
                                            <ComboBox Name="AvatarWarnColor" ItemsSource="{Binding DataContext.AlertColorOptions, RelativeSource={RelativeSource AncestorType=Window}}"
                                                          SelectedValuePath="Value" DisplayMemberPath="Key" Margin="2,2,2,2" Width="200"/>
                                        </StackPanel>

                                        <StackPanel Grid.Row="1" Grid.Column="1" Orientation="Horizontal" Margin="0,0,0,6" Grid.ColumnSpan="2">
                                            <Label Content="Nuisence:" VerticalAlignment="Center" HorizontalAlignment="Left" Height="26" Margin="32,0,0,0" Width="75"/>
                                            <ComboBox Name="AvatarNuisenceSound" ItemsSource="{Binding DataContext.AlertSoundOptions, RelativeSource={RelativeSource AncestorType=Window}}"
                                                          SelectedValuePath="Value" DisplayMemberPath="Key" Margin="2,2,2,2" Width="200"/>

                                            <Label Content="Color:" VerticalAlignment="Center" HorizontalAlignment="Left" Height="26" Margin="32,0,0,0" Width="75"/>
                                            <ComboBox Name="AvatarNuisenceColor" ItemsSource="{Binding DataContext.AlertColorOptions, RelativeSource={RelativeSource AncestorType=Window}}"
                                                          SelectedValuePath="Value" DisplayMemberPath="Key" Margin="2,2,2,2" Width="200"/>
                                        </StackPanel>

                                        <StackPanel Grid.Row="2" Grid.Column="1" Orientation="Horizontal" Margin="0,0,0,6" Grid.ColumnSpan="2">
                                            <Label Content="Crasher:" VerticalAlignment="Center" HorizontalAlignment="Left" Height="26" Margin="32,0,0,0" Width="75"/>
                                            <ComboBox Name="AvatarCrasherSound" ItemsSource="{Binding DataContext.AlertSoundOptions, RelativeSource={RelativeSource AncestorType=Window}}"
                                                          SelectedValuePath="Value" DisplayMemberPath="Key" Margin="2,2,2,2" Width="200"/>

                                            <Label Content="Color:" VerticalAlignment="Center" HorizontalAlignment="Left" Height="26" Margin="32,0,0,0" Width="75"/>
                                            <ComboBox Name="AvatarCrasherColor" ItemsSource="{Binding DataContext.AlertColorOptions, RelativeSource={RelativeSource AncestorType=Window}}"
                                                          SelectedValuePath="Value" DisplayMemberPath="Key" Margin="2,2,2,2" Width="200"/>
                                        </StackPanel>


                                        <Label Grid.Row="3" Grid.Column="0" Content="Group Alert:" VerticalAlignment="Center" HorizontalAlignment="Left" Height="26" Margin="32,0,0,0" Width="75"/>

                                        <StackPanel Grid.Row="3" Grid.Column="1" Orientation="Horizontal" Margin="0,0,0,6" Grid.ColumnSpan="2">
                                            <Label Content="Warn:" VerticalAlignment="Center" HorizontalAlignment="Left" Height="26" Margin="32,0,0,0" Width="75"/>
                                            <ComboBox Name="GroupWarnSound" ItemsSource="{Binding DataContext.AlertSoundOptions, RelativeSource={RelativeSource AncestorType=Window}}"
                                                          SelectedValuePath="Value" DisplayMemberPath="Key" Margin="2,2,2,2" Width="200"/>

                                            <Label Content="Color:" VerticalAlignment="Center" HorizontalAlignment="Left" Height="26" Margin="32,0,0,0" Width="75"/>
                                            <ComboBox Name="GroupWarnColor" ItemsSource="{Binding DataContext.AlertColorOptions, RelativeSource={RelativeSource AncestorType=Window}}"
                                                          SelectedValuePath="Value" DisplayMemberPath="Key" Margin="2,2,2,2" Width="200"/>
                                        </StackPanel>

                                        <StackPanel Grid.Row="4" Grid.Column="1" Orientation="Horizontal" Margin="0,0,0,6" Grid.ColumnSpan="2">
                                            <Label Content="Nuisence:" VerticalAlignment="Center" HorizontalAlignment="Left" Height="26" Margin="32,0,0,0" Width="75"/>
                                            <ComboBox Name="GroupNuisenceSound" ItemsSource="{Binding DataContext.AlertSoundOptions, RelativeSource={RelativeSource AncestorType=Window}}"
                                                          SelectedValuePath="Value" DisplayMemberPath="Key" Margin="2,2,2,2" Width="200"/>

                                            <Label Content="Color:" VerticalAlignment="Center" HorizontalAlignment="Left" Height="26" Margin="32,0,0,0" Width="75"/>
                                            <ComboBox Name="GroupNuisenceColor" ItemsSource="{Binding DataContext.AlertColorOptions, RelativeSource={RelativeSource AncestorType=Window}}"
                                                          SelectedValuePath="Value" DisplayMemberPath="Key" Margin="2,2,2,2" Width="200"/>
                                        </StackPanel>

                                        <StackPanel Grid.Row="5" Grid.Column="1" Orientation="Horizontal" Margin="0,0,0,6" Grid.ColumnSpan="2">
                                            <Label Content="Crasher:" VerticalAlignment="Center" HorizontalAlignment="Left" Height="26" Margin="32,0,0,0" Width="75"/>
                                            <ComboBox Name="GroupCrasherSound" ItemsSource="{Binding DataContext.AlertSoundOptions, RelativeSource={RelativeSource AncestorType=Window}}"
                                                          SelectedValuePath="Value" DisplayMemberPath="Key" Margin="2,2,2,2" Width="200"/>

                                            <Label Content="Color:" VerticalAlignment="Center" HorizontalAlignment="Left" Height="26" Margin="32,0,0,0" Width="75"/>
                                            <ComboBox Name="GroupCrasherColor" ItemsSource="{Binding DataContext.AlertColorOptions, RelativeSource={RelativeSource AncestorType=Window}}"
                                                          SelectedValuePath="Value" DisplayMemberPath="Key" Margin="2,2,2,2" Width="200"/>
                                        </StackPanel>


                                        <Label Grid.Row="6" Grid.Column="0" Content="Profile Alert:" VerticalAlignment="Center" HorizontalAlignment="Left" Height="26" Margin="32,0,0,0" Width="75"/>

                                        <StackPanel Grid.Row="6" Grid.Column="1" Orientation="Horizontal" Margin="0,0,0,6" Grid.ColumnSpan="2">
                                            <Label Content="Warn:" VerticalAlignment="Center" HorizontalAlignment="Left" Height="26" Margin="32,0,0,0" Width="75"/>
                                            <ComboBox Name="ProfileWarnSound" ItemsSource="{Binding DataContext.AlertSoundOptions, RelativeSource={RelativeSource AncestorType=Window}}"
                                                          SelectedValuePath="Value" DisplayMemberPath="Key" Margin="2,2,2,2" Width="200"/>

                                            <Label Content="Color:" VerticalAlignment="Center" HorizontalAlignment="Left" Height="26" Margin="32,0,0,0" Width="75"/>
                                            <ComboBox Name="ProfileWarnColor" ItemsSource="{Binding DataContext.AlertColorOptions, RelativeSource={RelativeSource AncestorType=Window}}"
                                                          SelectedValuePath="Value" DisplayMemberPath="Key" Margin="2,2,2,2" Width="200"/>
                                        </StackPanel>

                                        <StackPanel Grid.Row="7" Grid.Column="1" Orientation="Horizontal" Margin="0,0,0,6" Grid.ColumnSpan="2">
                                            <Label Content="Nuisence:" VerticalAlignment="Center" HorizontalAlignment="Left" Height="26" Margin="32,0,0,0" Width="75"/>
                                            <ComboBox Name="ProfileNuisenceSound" ItemsSource="{Binding DataContext.AlertSoundOptions, RelativeSource={RelativeSource AncestorType=Window}}"
                                                          SelectedValuePath="Value" DisplayMemberPath="Key" Margin="2,2,2,2" Width="200"/>

                                            <Label Content="Color:" VerticalAlignment="Center" HorizontalAlignment="Left" Height="26" Margin="32,0,0,0" Width="75"/>
                                            <ComboBox Name="ProfileNuisenceColor" ItemsSource="{Binding DataContext.AlertColorOptions, RelativeSource={RelativeSource AncestorType=Window}}"
                                                          SelectedValuePath="Value" DisplayMemberPath="Key" Margin="2,2,2,2" Width="200"/>
                                        </StackPanel>

                                        <StackPanel Grid.Row="8" Grid.Column="1" Orientation="Horizontal" Margin="0,0,0,6" Grid.ColumnSpan="2">
                                            <Label Content="Crasher:" VerticalAlignment="Center" HorizontalAlignment="Left" Height="26" Margin="32,0,0,0" Width="75"/>
                                            <ComboBox Name="ProfileCrasherSound" ItemsSource="{Binding DataContext.AlertSoundOptions, RelativeSource={RelativeSource AncestorType=Window}}"
                                                          SelectedValuePath="Value" DisplayMemberPath="Key" Margin="2,2,2,2" Width="200"/>

                                            <Label Content="Color:" VerticalAlignment="Center" HorizontalAlignment="Left" Height="26" Margin="32,0,0,0" Width="75"/>
                                            <ComboBox Name="ProfileCrasherColor" ItemsSource="{Binding DataContext.AlertColorOptions, RelativeSource={RelativeSource AncestorType=Window}}"
                                                          SelectedValuePath="Value" DisplayMemberPath="Key" Margin="2,2,2,2" Width="200"/>
                                        </StackPanel>


                                    </Grid>
                                </GroupBox>

                                <StackPanel Orientation="Horizontal" Grid.Row="4" HorizontalAlignment="Center" VerticalAlignment="Top" Margin="0,6,0,0">
                                    <Button Content="Save Config" Click="SaveAlerts_Click" Width="120" />
                                </StackPanel>
                            </Grid>
                        </TabItem>
                    </TabControl>
                </TabItem>

            </TabControl>


        </Grid>

        <!-- Status Bar -->
        <StatusBar Grid.Row="1" Background="#FF2D2D30" Foreground="#FFE6E6E6">
            <StatusBarItem HorizontalAlignment="Left">
                <TextBlock>
                    <Run Text="Instance: "/>
                    <Run Text="{Binding InstanceId, Mode=OneWay}" FontWeight="Bold"/>
                </TextBlock>
            </StatusBarItem>
            <Separator Style="{StaticResource {x:Static ToolBar.SeparatorStyleKey}}" />
            <StatusBarItem HorizontalAlignment="Right">
                <TextBlock>
                    <Run Text="Avatar Queue: "/>
                    <Run Text="{Binding AvatarQueueLength, Mode=OneWay}" FontWeight="Bold"/>
                </TextBlock>
            </StatusBarItem>
            <Separator Style="{StaticResource {x:Static ToolBar.SeparatorStyleKey}}" />
            <StatusBarItem HorizontalAlignment="Right">
                <TextBlock>
                    <Run Text="AI Queue: "/>
                    <Run Text="{Binding OllamaQueueLength, Mode=OneWay}" FontWeight="Bold"/>
                </TextBlock>
            </StatusBarItem>
            <Separator Style="{StaticResource {x:Static ToolBar.SeparatorStyleKey}}" />
            <StatusBarItem HorizontalAlignment="Right">
                <TextBlock>
                    <Run Text="Elapsed: "/>
                    <Run Text="{Binding ElapsedTime, Mode=OneWay}" FontWeight="Bold"/>
                </TextBlock>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>